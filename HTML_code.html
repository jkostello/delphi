<!DOCTYPE html>
<!-- language for the document-->
<html lang = "en">
<head>
    <meta charset = "UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Password Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 90%;
            margin: 20px auto;
            background-color: #f2f2f2;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        h1 {
            text-align: center;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        @media (max-width: 768px) {
            .containter {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class = "container">
        <h1> Password Manager</h1>
        <table id ="passwordTable">
            <thead>
                <tr>
                    <th>Website</th>
                    <th>Username</th>
                    <th>Password</th>
                </tr>
            </thead>
            <tbody id = "passwordRows"></tbody>
        </table>
        <form id = "passwordFrom">
            <label for = "website">Website:</label>
            <input type = "text" id = "website" name = "website"
            <label for = "username">Username:</label>
            <input type = "text" id = "username" name = "username">
            <label for = "password">Password:</label>
            <input type = "password" id = "password" name = "password">
            <button type = "button" onclick = "addRow()">Add Row</button>
        </form>
    </div>>

    <script>
        //Got from chatgpt, function to sent HTTP GET request to /get-pass endpoint
        async function getPasswords() {
            try {
                const response = await fetch('/get-pass');
                if(!responce.ok) {
                    throw new Error('Failed to fetch passwords');
                }
                const data = await response.json();
                buildTable(data);
            } catch (error) {
                console.error(error);
            }
        }

        //Function to build table rows based on JSON response
        function buildTable(data) {
            const tableBody = document.getElementById('passwordRows');
            tableBody.innerHTML = ' ';
            data.forEach(entry => {
                const newRow = tableBody.insertRow();
                newRow.innerHTML = 
                '<td>$(entry.website)</td>'
                '<td>$(entry.username)</td>'
                '<td>$(entry.password)</td>'
                ;
            });

            }

             //Function to send HTTP POST request to /add-pass endpoint
             async function addPassword() {
                const website = document.getElementById('website').value;
                const username = document.getELementById('username').value;
                const password = document.getElementById('password').value;

                try {
                    const response = await fetch('/add-pass', {
                        method: 'POST',
                        header: {
                            'Constant-Type': 'application/json'
                        },
                        body: JSON.stringify({ website, username, password})
                    });
                    if (!response.ok) {
                        throw new Error('Failed to add password');
                    }
                    getPassword();
                } catch (error) {
                    console.error(error);
                }
             }

             getPasswords();
    </script>
</body>
</html>
